<html>
<head>
	<style>
		@import url('https://fonts.googleapis.com/css?family=Roboto:400,700');
		body, input {
			font-family: Roboto;
			font-size: 12pt;
		}

		body { margin:10px; background-color: #eee; color: #000; }
		table, tbody {
			width:100%;
			height:100%;
			padding:0;
			margin:0;
			vertical-align:top
		}
		td  {
			padding:0;
			margin:0;
		}
		.c_select { border:solid 1px #ccc; padding:15px 10px; background:#fff; color:black; width:1002px; box-sizing:border-box  }
		
		#maps_chart, #tree_chart {
			margin-top:10px;
		}
		
		#maps_chart svg, #tree_chart svg {
			border: solid 1px #ccc;
			background:#fff
		}
	</style>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="easyac/jquery.easy-autocomplete.min.js"></script> 
	<link rel="stylesheet" href="easyac/easy-autocomplete.min.css"> 
	<script type="text/javascript">
		// Load Tradedata
		var tdata;
		
		function getCountries() {
			var lst = [];
			$.each(tdata["cc_index"], function( k, v ) {
				lst.push({"name":v["Name"], "code":k});
			});
			return lst;
		}

		$( document ).on("tdata_loaded", function() {
			// init autocomplete texlinesSettingstfield
			var options = {
				data: getCountries(),
				getValue: "name",
				list: {
					onChooseEvent: function() {
						selectedCountry();
					},
					match: {
						enabled: true
					}
				}
			};
			$("#c_selector").easyAutocomplete(options);
		});

		$( document ).ready(function() {
			$.getJSON( "data.json", function( data ) {
				tdata = data;
				$( document ).trigger( "tdata_loaded");
			});
		});
	</script>

	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	<script type="text/javascript">
	google.charts.load('current', {
		'packages':['geochart','treemap'],
		'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
	});
	google.charts.setOnLoadCallback(drawRegionsMap);

	function drawRegionsMap() {
		var data = google.visualization.arrayToDataTable([
		['Country', 'Popularity'],
		['Germany', -100000],
		['United States', 300],
		['Brazil', 400],
		['Canada', 500],
		['France', 600],
		['RU', 700]
		]);
		

		var options = {
			width:1000,
			height:600,
			colorAxis: {colors: ['#e31b23', '#fff', '#00853f']}
		};

		var chart = new google.visualization.GeoChart(document.getElementById('maps_chart'));

		chart.draw(data, options);



		var data = google.visualization.arrayToDataTable([
				['Location', 'Parent', 'Market trade volume (size)', 'Market increase/decrease (color)'],
				['Global',    null,                 0,                               0],
				['Brazil',    'Global',            11,                              10],
				['USA',       'Global',            52,                              31],
				['Mexico',    'Global',            24,                              12],
				['Canada',    'Global',            16,                              -23],
				['France',    'Global',             42,                              -11],
				['Germany',   'Global',             31,                              -2],
				['Sweden',    'Global',             22,                              -13],
				['Italy',     'Global',             17,                              4],
				['UK',        'Global',             21,                              -5],
				['China',     'Global',               36,                              4],
				['Japan',     'Global',               20,                              -12],
				['India',     'Global',               40,                              63],
				['Laos',      'Global',               4,                               34],
				['Mongolia',  'Global',               1,                               -5],
				['Israel',    'Global',               12,                              24],
				['Iran',      'Global',               18,                              13],
				['Pakistan',  'Global',               11,                              -52],
				['Egypt',     'Global',             21,                              0],
				['S. Africa', 'Global',             30,                             43],
				['Sudan',     'Global',             12,                              2],
				['Congo',     'Global',             10,                              12],
				['Zaire',     'Global',             8,                               10]
				]);

        tree = new google.visualization.TreeMap(document.getElementById('tree_chart'));

        tree.draw(data, {
          minColor: '#e31b23',
          midColor: '#fff',
          maxColor: '#00853f',
          headerHeight: 0,
          fontColor: 'black',
          showScale: false,
          width:1010,
        });
	}
	</script>
	
	<script type="text/javascript">	
		function selectedCountry() {
			var ccode = $("#c_selector").getSelectedItemData().code;

			var baseCountry = {"Name":tdata["cc_index"][ccode]["Name"], "Latitude": tdata["cc_index"][ccode]["Latitude"], "Longitude": tdata["cc_index"][ccode]["Longitude"]};
			var tradeData = [];
			
			$.each(tdata["trade_data"][ccode], function(exp_key, ec){
				tradeData.push({
					"Name":tdata["cc_index"][exp_key]["Name"], 
					"Latitude": tdata["cc_index"][exp_key]["Latitude"], 
					"Longitude": tdata["cc_index"][exp_key]["Longitude"], 
					"ExportAmount": tdata["trade_data"][ccode][exp_key]["ExportAmount"],
					"ImportAmount": tdata["trade_data"][ccode][exp_key]["ImportAmount"],
					"ExportAmountPercentage": tdata["trade_data"][ccode][exp_key]["ExportAmountPercentage"],
					"ImportAmountPercentage": tdata["trade_data"][ccode][exp_key]["ImportAmountPercentage"]
				});
			});
		}
	</script>

</head>
<body>
	<table>
		<tr>
			<td>
				<div class="c_select">
					<b>Select Country:</b> <input type="text" name="c_selector" id="c_selector" />
				</div>
			</td>
		</tr>
		<tr height="100%">
			<td>
				<div id="maps_chart"></div>
			</td>
		</tr>
		<tr>
			<td>
				<div id="tree_chart"></div>
			</td>
		</tr>
	</table>


	
</body>
</html>
